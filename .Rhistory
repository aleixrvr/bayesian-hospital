knitr::opts_chunk$set(echo = TRUE)
library("bigrquery")
library(DBI)
library(dplyr)
library(data.table)
library(magrittr)
Sys.setenv(BIGQUERY_TEST_PROJECT="bgse-dsc")
billing <- bq_test_project()
con <- dbConnect(
bigrquery::bigquery(),
project = "bgse-dsc",
dataset = "MIMIC3_V1_4",
billing = billing
)
sql <- "select SUBJECT_ID, COUNT(DISTINCT CGID)
from `MIMIC3_V1_4.CHARTEVENTS`
group by SUBJECT_ID"
res <- dbGetQuery(con, sql)
res <- dbGetQuery(con, sql)
knitr::opts_chunk$set(echo = TRUE)
library("bigrquery")
library(DBI)
library(dplyr)
library(data.table)
library(magrittr)
Sys.setenv(BIGQUERY_TEST_PROJECT="bgse-dsc")
billing <- bq_test_project()
con <- dbConnect(
bigrquery::bigquery(),
project = "bgse-dsc",
dataset = "MIMIC3_V1_4",
billing = billing
)
sql <- "select SUBJECT_ID, COUNT(DISTINCT CGID)
from `MIMIC3_V1_4.CHARTEVENTS`
group by SUBJECT_ID"
res <- dbGetQuery(con, sql)
res %>% as.data.table()
res %>% as.data.table() -> res
res
res[, quantile(f0_)]
sql <- "select SUBJECT_ID, ICUSTAY_ID, COUNT(DISTINCT CGID)
from `MIMIC3_V1_4.CHARTEVENTS`
group by SUBJECT_ID, ICUSTAY_ID"
res <- dbGetQuery(con, sql) %>% as.data.table
res
res[, quantile(f0_)]
library(data.table)
labevents <- fread('/Users/aleixrvr/Projects/Data/aaa/LABEVENTS.csv')
nrow(labevents)
labevents
aa <- fread('/Users/aleixrvr/Downloads/large-demo-data-1.11.9.sql')
library(data.table)
aa <- fread('/Users/aleixrvr/Downloads/large-demo-data-1.11.9.sql')
60*8*20
library(magrittr)
library(data.table)
library(magrittr)
library("bigrquery")
library(DBI)
library(dplyr)
library(data.table)
billing <- bq_test_project()
con <- dbConnect(
bigrquery::bigquery(),
project = "bgse-dsc",
dataset = "MIMIC3_V1_4",
billing = billing
)
admissions <- tbl(con, "TRANSFERS")
admissions <- as.data.table(admissions)
billing <- bq_test_project()
library(magrittr)
library("bigrquery")
library(DBI)
library(dplyr)
library(data.table)
Sys.setenv(BIGQUERY_TEST_PROJECT="bgse-dsc")
billing <- bq_test_project()
con <- dbConnect(
bigrquery::bigquery(),
project = "bgse-dsc",
dataset = "MIMIC3_V1_4",
billing = billing
)
admissions <- tbl(con, "TRANSFERS")
admissions <- as.data.table(admissions)
transfers <- admissions
transfers %>% View
knitr::opts_chunk$set(echo = TRUE)
library(magrittr)
library("bigrquery")
library(DBI)
library(dplyr)
library(data.table)
Sys.setenv(BIGQUERY_TEST_PROJECT="bgse-dsc")
billing <- bq_test_project()
con <- dbConnect(
bigrquery::bigquery(),
project = "bgse-dsc",
dataset = "MIMIC3_V1_4",
billing = billing
)
transfers <- tbl(con, "TRANSFERS")
transfers <- as.data.table(transfers)
transfers[, unique(PREV_CAREUNIT)]
transfers[, unique(CURR_CAREUNIT)]
services <- tbl(con, "SERVICES")
services <- as.data.table(services)
View(services)
items <- tbl(con, "D_ITEMS")
items <- tbl(con, "D_ITEMS") %>% as.data.table
items %>% View
items[, LINKSTO %>% unique()]
items[LINKSTO=="datetimeevents"] %>% View
items[, CATEGORY %>% unique()]
items[, UNITNAME %>% unique()]
items[, CONCEPTID %>% unique()]
items %>% View
icustays <- tbl(con, "ICUSTAYS") %>% as.data.table
icustays[, FIRST_CAREUNIT %>% unique()]
transfers <- tbl(con, "TRANSFERS") %>% as.data.table
transfers[, PREV_CAREUNIT %>% uniqeu]
transfers[, PREV_CAREUNIT %>% unique()]
transfers[is.na(PREV_CAREUNIT), PREV_CAREUNIT:='OUT']
transfers[is.na(CURR_CAREUNIT), CURR_CAREUNIT:='OUT']
transfers[, PREV_CAREUNIT %>% unique()]
transfers
transfer %>% View
transfers %>% View
transfers[, class(INTIME)]
transfers[, OUTTIME - INTIME]
transfers[!is.na(INTIME), OUTTIME - INTIME]
transfers[!is.na(INTIME), OUTTIME - INTIME][1:10]
transfers[!is.na(INTIME), .(OUTTIME - INTIME, INTIME, OUTIME)][1:10]
transfers[!is.na(INTIME), .(OUTTIME - INTIME, INTIME, OUTTIME)][1:10]
transfers[, TIME: = difftime(OUTTIME, INTIME, units = 'days')]
transfers[, TIME:= difftime(OUTTIME, INTIME, units = 'days')]
transfers %>% View
transfers[, .(los = mean(LOS)), .(PREV_CAREUNIT, CURR_CAREUNIT)]
transfers[, .(n = .N), .(PREV_CAREUNIT, CURR_CAREUNIT)]
colnames(transfers)
setorder(transfers, 'SUBJECT_ID')
setorder(transfers, 'SUBJECT_ID', 'PREV_CAREUNIT')
View(transfers)
View(transfers[, .(SUBJECT_ID, HADM_ID, ICUSTAY_ID, PREV_CAREUNIT, CURR_CAREUNIT, INTIME, OUTTIME)])
setorder(transfers, 'SUBJECT_ID', 'PREV_CAREUNIT', 'INTIME')
View(transfers[, .(SUBJECT_ID, HADM_ID, ICUSTAY_ID, PREV_CAREUNIT, CURR_CAREUNIT, INTIME, OUTTIME)])
setorder(transfers, 'SUBJECT_ID', 'INTIME')
View(transfers[, .(SUBJECT_ID, HADM_ID, ICUSTAY_ID, PREV_CAREUNIT, CURR_CAREUNIT, INTIME, OUTTIME)])
View(transfers[, .(SUBJECT_ID, HADM_ID, ICUSTAY_ID, PREV_CAREUNIT, CURR_CAREUNIT, INTIME, OUTTIME, LOS)])
View(transfers[, .(SUBJECT_ID, HADM_ID, ICUSTAY_ID, PREV_CAREUNIT, CURR_CAREUNIT, INTIME, OUTTIME)])
View(transfers[, .(SUBJECT_ID, HADM_ID, ICUSTAY_ID, PREV_CAREUNIT, CURR_CAREUNIT, INTIME, OUTTIME, LOS)])
